#include "U8glib.h"
#include <Bounce2.h>
#include <avr/pgmspace.h>
#include <JeeLib.h>


// fonty
const u8g_fntpgm_uint8_t witch14n[317] U8G_FONT_SECTION("witch14n") = {
  0,31,33,253,250,15,0,0,0,0,48,57,0,15,0,15,
  0,9,15,30,11,1,0,56,0,62,0,70,0,67,0,195,
  0,195,128,195,128,195,128,195,128,195,128,195,128,67,0,67,
  0,62,0,28,0,8,15,15,10,1,0,24,248,120,24,24,
  24,24,24,24,24,24,24,28,255,255,8,15,15,10,1,0,
  60,70,131,131,131,195,70,14,28,16,32,65,193,255,255,9,
  15,30,11,1,0,124,0,255,0,227,0,227,0,67,0,6,
  0,124,0,15,0,3,128,195,128,195,128,195,128,199,128,255,
  0,60,0,10,15,30,12,1,0,2,0,6,0,7,0,14,
  0,30,0,30,0,54,0,102,0,102,0,255,128,255,192,6,
  0,7,0,63,192,63,192,9,15,30,11,1,0,62,0,126,
  0,120,0,0,0,0,0,126,0,103,0,3,128,3,128,3,
  128,227,128,231,0,199,0,126,0,56,0,9,15,30,10,1,
  0,12,0,6,0,70,0,70,0,192,0,192,0,254,0,227,
  0,195,0,195,128,195,128,195,128,195,0,7,0,60,0,8,
  15,15,9,1,0,126,255,124,0,0,8,8,24,24,56,56,
  56,56,56,24,9,15,30,11,1,0,62,0,97,128,65,128,
  193,128,225,0,126,0,62,0,63,0,111,0,195,128,193,128,
  193,128,193,0,103,0,60,0,8,15,15,10,1,0,56,124,
  98,195,195,195,199,231,71,2,98,96,108,124,56};
  
const u8g_fntpgm_uint8_t witch18n[455] U8G_FONT_SECTION("witch18n") = {
  0,41,43,252,248,19,0,0,0,0,48,57,0,19,0,19,
  0,12,19,38,14,1,0,30,0,63,0,51,128,97,192,97,
  224,224,224,224,224,224,240,224,240,224,240,224,240,224,240,224,
  240,96,240,96,224,32,192,33,192,31,128,15,0,10,19,38,
  12,1,0,6,0,254,0,254,0,30,0,14,0,14,0,14,
  0,14,0,14,0,14,0,14,0,14,0,14,0,14,0,14,
  0,14,0,63,0,255,192,127,128,11,19,38,13,1,0,31,
  0,49,192,96,224,64,224,128,224,128,224,128,224,240,192,113,
  192,3,128,7,0,4,0,8,0,16,0,48,32,48,96,127,
  224,127,224,63,224,13,19,38,15,1,0,31,0,63,192,113,
  224,120,224,120,224,112,192,1,192,3,128,31,128,3,192,0,
  240,0,112,112,120,240,120,240,248,224,240,97,240,63,192,31,
  0,13,19,38,15,1,0,1,128,3,128,3,128,7,128,7,
  128,15,128,31,128,27,128,59,128,51,128,99,128,103,128,255,
  240,255,240,3,128,3,128,15,240,31,248,31,240,11,18,36,
  15,2,0,63,128,127,0,124,0,0,0,0,0,0,0,63,
  0,99,192,1,192,1,224,1,224,65,224,225,224,227,192,195,
  192,231,128,127,0,28,0,11,19,38,13,1,0,14,0,3,
  0,3,128,99,128,99,128,99,128,224,0,224,0,255,0,241,
  128,225,192,225,224,225,224,225,224,225,224,193,224,65,192,3,
  128,63,0,10,19,38,12,1,0,127,128,255,192,255,0,0,
  0,0,0,0,0,2,0,6,0,6,0,14,0,14,0,14,
  0,30,0,30,0,30,0,30,0,30,0,30,0,14,0,12,
  19,38,14,1,0,31,128,48,192,96,224,64,224,224,224,224,
  224,248,192,127,192,63,192,31,192,55,224,97,224,224,112,224,
  112,224,112,224,96,96,224,55,192,31,0,11,19,38,13,1,
  0,30,0,63,0,113,128,96,192,224,224,224,224,224,224,224,
  224,225,224,225,224,97,192,0,192,0,192,96,128,112,0,97,
  0,127,0,63,0,28,0};
  
const u8g_fntpgm_uint8_t witch22n[558] U8G_FONT_SECTION("witch22n") = {
  0,49,52,252,246,23,0,0,0,0,48,57,0,23,0,23,
  0,14,23,46,16,1,0,7,128,31,192,63,224,56,112,120,
  112,112,120,112,56,240,56,240,56,240,60,240,60,240,60,240,
  60,240,60,240,60,112,60,112,56,112,56,48,48,56,112,31,
  224,15,192,7,128,12,23,46,14,1,0,3,0,127,0,255,
  0,63,0,15,0,7,0,7,0,7,0,7,0,7,0,7,
  0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,
  128,15,128,127,240,255,240,127,224,13,23,46,15,1,0,15,
  128,57,224,32,112,64,120,64,56,128,56,128,56,240,56,248,
  112,112,112,0,224,1,192,3,128,2,0,4,0,8,0,24,
  0,16,8,48,24,127,248,127,248,127,248,63,248,15,23,46,
  17,1,0,7,0,31,224,63,240,120,120,124,56,124,56,124,
  56,48,112,0,224,7,224,31,192,3,240,0,124,0,60,48,
  60,120,62,248,62,240,126,240,124,224,252,123,248,63,224,15,
  128,17,23,69,19,1,0,0,32,0,0,112,0,0,240,0,
  0,240,0,1,240,0,1,240,0,3,240,0,7,240,0,15,
  224,0,14,224,0,28,224,0,24,224,0,56,224,0,48,224,
  0,127,252,0,127,255,0,255,254,0,0,240,0,0,240,0,
  0,248,0,15,255,0,31,255,128,7,254,0,13,22,44,18,
  2,0,63,192,127,224,127,128,62,0,0,0,0,0,0,0,
  63,128,121,224,96,240,0,120,0,120,0,120,0,120,224,120,
  240,248,241,240,193,240,225,224,127,192,63,128,30,0,13,23,
  46,15,1,0,7,192,1,224,0,224,32,240,48,240,96,240,
  96,224,96,0,224,0,231,128,255,224,252,112,240,56,240,56,
  224,56,224,56,224,56,224,56,224,56,96,120,0,112,1,224,
  63,128,12,23,46,14,1,0,127,224,255,240,255,240,127,192,
  0,0,0,0,0,0,1,0,3,0,3,0,7,0,7,0,
  15,0,15,0,15,0,31,0,31,0,31,0,31,0,31,0,
  31,0,15,0,14,0,15,23,46,17,1,0,15,192,31,240,
  48,56,96,56,96,56,224,56,224,56,240,48,126,112,63,240,
  63,240,31,248,63,248,112,252,224,62,224,30,224,14,224,14,
  224,12,112,28,48,120,31,240,15,192,14,23,46,16,1,0,
  15,128,63,192,63,240,120,112,112,56,240,56,224,60,224,60,
  224,60,224,124,240,124,112,252,112,248,0,56,0,56,0,48,
  112,48,120,0,112,0,51,192,63,192,63,128,30,0};
  
const u8g_fntpgm_uint8_t witch26n[723] U8G_FONT_SECTION("witch26n") = {
  0,58,63,251,244,27,0,0,0,0,48,57,0,27,0,27,
  0,17,27,81,19,1,0,7,192,0,15,240,0,31,248,0,
  60,120,0,56,60,0,120,30,0,112,30,0,112,31,0,112,
  15,0,240,15,0,240,15,0,240,15,128,240,15,128,240,15,
  128,240,15,128,240,15,128,240,15,128,240,15,128,112,15,128,
  112,15,0,48,15,0,56,30,0,24,30,0,24,60,0,15,
  248,0,7,240,0,3,192,0,15,27,54,17,1,0,3,192,
  127,192,255,192,127,192,15,192,7,192,7,192,7,192,7,192,
  7,128,7,128,7,128,7,128,7,128,7,128,7,128,7,128,
  7,128,7,128,7,128,7,192,7,192,7,224,31,248,255,254,
  255,254,63,248,16,27,54,18,1,0,7,224,31,248,24,62,
  48,30,96,15,64,15,128,15,128,15,192,15,248,14,124,30,
  56,28,0,56,0,112,0,224,1,128,1,0,2,0,4,0,
  8,1,24,1,24,7,63,255,127,255,127,255,127,255,31,254,
  18,27,81,21,2,0,15,192,0,31,240,0,63,252,0,124,
  124,0,126,30,0,126,30,0,126,28,0,126,28,0,24,56,
  0,0,120,0,0,240,0,31,224,0,15,224,0,0,252,0,
  0,31,0,0,15,128,0,15,128,120,15,128,252,15,192,248,
  15,192,248,31,192,248,31,128,240,63,128,240,127,0,127,254,
  0,31,248,0,15,192,0,19,27,81,22,2,0,0,24,0,
  0,56,0,0,56,0,0,124,0,0,124,0,0,252,0,1,
  248,0,3,248,0,3,248,0,7,248,0,7,248,0,15,120,
  0,30,120,0,28,120,0,56,120,0,56,120,0,120,252,0,
  127,255,192,255,255,192,255,255,128,0,120,0,0,56,0,0,
  124,0,1,255,128,15,255,224,15,255,224,3,255,128,16,26,
  52,21,2,0,31,248,63,252,63,248,63,224,31,0,0,0,
  0,0,0,0,15,192,63,248,60,124,56,62,0,62,0,31,
  0,31,0,31,32,31,112,31,248,63,248,126,240,126,112,124,
  120,248,63,240,31,192,7,0,15,27,54,18,1,0,3,224,
  0,240,0,120,0,60,48,124,48,124,112,124,112,120,112,0,
  112,0,240,0,247,224,255,248,254,60,248,28,248,30,240,30,
  240,30,240,30,240,30,240,30,240,30,224,30,64,60,0,120,
  1,240,31,224,14,27,54,16,1,0,63,248,255,252,255,252,
  255,248,127,224,0,0,0,0,0,0,0,0,0,128,1,128,
  1,128,3,128,3,128,3,128,7,128,7,128,7,128,15,128,
  15,128,15,128,15,128,15,128,15,128,15,128,7,128,7,0,
  18,27,81,20,1,0,7,240,0,31,252,0,60,30,0,48,
  14,0,112,15,0,96,15,0,224,15,0,240,14,0,248,14,
  0,126,28,0,127,252,0,63,252,0,31,252,0,31,254,0,
  31,255,0,56,127,0,112,31,128,240,7,128,240,7,192,240,
  3,192,240,3,128,240,3,128,112,7,0,56,15,0,60,126,
  0,15,248,0,7,224,0,16,27,54,18,1,0,15,192,31,
  240,63,248,60,124,120,60,112,30,112,30,240,31,240,31,240,
  31,240,63,240,63,248,63,120,126,120,126,16,62,0,30,0,
  28,16,28,56,24,120,0,120,0,56,224,63,224,63,224,31,
  192,15,0};
  
const u8g_fntpgm_uint8_t witch30n[973] U8G_FONT_SECTION("witch30n") = {
  0,67,72,250,242,31,0,0,0,0,48,57,0,31,0,31,
  0,20,31,93,22,1,0,1,224,0,7,248,0,15,252,0,
  31,254,0,30,15,0,60,15,128,60,7,128,120,7,192,120,
  7,192,120,3,224,248,3,224,248,3,224,248,3,224,248,3,
  240,248,3,240,248,3,240,248,3,240,248,3,240,248,3,240,
  248,3,240,120,3,240,120,3,224,120,3,224,56,3,224,60,
  7,192,28,7,128,12,7,128,15,255,0,7,254,0,3,252,
  0,0,240,0,17,31,93,19,1,0,0,224,0,31,224,0,
  255,224,0,255,224,0,127,224,0,3,224,0,3,224,0,1,
  224,0,1,224,0,1,224,0,1,224,0,1,224,0,1,224,
  0,1,224,0,1,224,0,1,224,0,1,224,0,1,224,0,
  1,224,0,1,224,0,1,224,0,1,224,0,1,224,0,1,
  240,0,3,240,0,3,240,0,3,248,0,127,255,0,255,255,
  128,255,255,128,31,252,0,18,31,93,20,1,0,7,240,0,
  15,254,0,28,31,0,48,15,128,32,7,128,64,7,192,64,
  3,192,128,3,192,128,3,192,192,3,192,248,7,192,252,7,
  128,124,15,128,16,15,0,0,30,0,0,60,0,0,120,0,
  0,240,0,0,192,0,1,128,0,3,0,0,6,0,0,12,
  0,64,12,0,64,24,0,192,60,3,192,63,255,192,127,255,
  192,127,255,192,127,255,192,31,255,128,21,31,93,24,2,0,
  7,224,0,31,252,0,63,254,0,127,255,0,126,15,128,127,
  7,128,127,7,128,127,7,128,62,7,0,28,15,0,0,30,
  0,0,60,0,7,252,0,31,248,0,3,252,0,0,31,128,
  0,7,192,0,7,224,0,3,224,60,3,224,252,3,248,252,
  3,248,252,3,248,252,7,248,248,15,240,248,15,240,248,63,
  224,127,255,192,63,255,0,31,252,0,7,224,0,23,31,93,
  25,1,0,0,6,0,0,15,0,0,15,0,0,31,0,0,
  31,0,0,63,0,0,127,0,0,127,0,0,255,0,1,255,
  0,1,255,0,3,254,0,7,222,0,7,158,0,15,30,0,
  14,30,0,30,30,0,28,30,0,60,62,0,63,255,224,127,
  255,252,127,255,252,255,255,248,0,63,0,0,30,0,0,31,
  0,0,63,224,3,255,252,7,255,254,7,255,254,1,255,240,
  19,30,90,26,3,0,31,254,0,63,255,0,63,254,0,63,
  248,0,31,128,0,0,0,0,0,0,0,0,0,0,0,0,
  0,0,0,0,15,248,0,63,254,0,62,63,128,60,15,192,
  16,15,192,0,7,224,0,7,224,0,7,224,0,7,224,48,
  7,224,120,7,224,252,15,192,252,31,192,252,31,192,112,31,
  128,120,63,0,63,254,0,31,252,0,15,240,0,3,192,0,
  18,31,93,20,1,0,1,248,0,0,124,0,0,30,0,0,
  14,0,16,15,0,56,31,0,56,31,0,120,31,0,120,14,
  0,112,0,0,112,0,0,112,0,0,249,248,0,255,252,0,
  255,14,0,254,7,0,252,7,128,248,7,128,248,3,192,248,
  3,192,240,7,192,240,7,192,240,7,192,240,7,192,240,7,
  128,112,7,128,96,15,128,0,15,0,0,62,0,1,252,0,
  31,240,0,16,31,62,18,1,0,63,252,255,255,255,255,255,
  254,127,240,0,0,0,0,0,0,0,0,0,0,0,32,0,
  96,0,224,0,224,0,224,1,224,1,224,1,224,3,224,3,
  224,3,224,7,224,7,224,7,224,7,224,7,224,7,224,7,
  224,7,224,3,224,1,192,20,31,93,22,1,0,3,248,0,
  15,255,0,30,7,128,56,3,192,48,3,192,112,3,192,112,
  3,192,240,3,192,248,3,192,252,3,128,127,7,128,127,255,
  128,63,255,0,31,255,128,15,255,128,15,255,128,31,255,192,
  60,63,224,120,15,224,120,3,240,240,1,240,240,0,240,240,
  0,240,240,0,240,240,0,240,120,1,224,120,3,192,60,15,
  128,31,127,0,15,254,0,3,248,0,18,31,93,20,1,0,
  7,192,0,15,248,0,31,252,0,63,190,0,62,15,0,124,
  15,0,120,7,128,120,7,128,240,7,192,240,7,192,240,7,
  192,240,7,192,240,15,192,248,15,192,248,31,192,124,31,128,
  124,31,128,56,31,128,0,7,128,0,7,128,0,7,0,24,
  7,0,60,6,0,60,0,0,60,0,0,60,56,0,60,248,
  0,31,248,0,31,248,0,31,224,0,7,128,0};
  
const u8g_fntpgm_uint8_t witch34n[1165] U8G_FONT_SECTION("witch34n") = {
  0,76,80,249,242,35,0,0,0,0,48,57,0,36,0,35,
  0,22,35,105,24,1,0,1,248,0,3,252,0,7,255,0,
  15,255,128,31,15,128,30,7,192,62,3,224,62,3,224,124,
  3,240,124,3,240,124,1,240,124,1,248,252,1,248,252,1,
  248,252,1,248,252,1,252,252,1,252,252,1,252,252,1,252,
  252,1,252,252,1,252,252,1,252,124,1,252,124,1,252,124,
  1,248,60,1,248,60,1,240,30,1,240,30,3,224,14,3,
  224,15,7,192,7,255,128,3,255,0,1,254,0,0,120,0,
  19,35,105,21,1,0,0,112,0,127,248,0,255,248,0,255,
  248,0,127,248,0,3,248,0,1,248,0,1,248,0,1,248,
  0,1,248,0,1,248,0,1,240,0,1,240,0,1,240,0,
  1,240,0,1,240,0,1,240,0,1,240,0,1,240,0,1,
  240,0,1,240,0,1,240,0,1,240,0,1,240,0,1,240,
  0,1,248,0,1,248,0,1,248,0,1,248,0,3,252,0,
  31,255,128,127,255,224,255,255,224,127,255,192,15,254,0,21,
  36,108,23,1,0,1,252,0,7,255,128,15,15,192,28,3,
  240,56,3,240,48,1,248,96,0,248,96,0,248,192,0,248,
  192,0,248,192,0,248,224,0,248,254,1,240,255,1,240,127,
  3,240,30,3,224,0,7,192,0,15,128,0,15,0,0,30,
  0,0,56,0,0,112,0,0,224,0,0,192,0,1,128,0,
  3,0,0,6,0,8,6,0,8,14,0,24,31,0,120,31,
  255,248,63,255,248,63,255,248,63,255,248,31,255,248,7,255,
  240,23,35,105,26,2,0,3,248,0,15,255,0,31,255,128,
  63,255,224,126,7,224,127,3,240,127,129,240,127,129,240,127,
  129,224,63,1,224,62,3,192,0,7,192,0,15,128,0,63,
  0,15,255,0,15,254,0,1,255,0,0,31,224,0,7,248,
  0,3,248,0,1,248,28,1,248,126,1,252,254,1,254,254,
  1,254,254,3,254,252,3,254,252,7,252,248,7,252,248,15,
  248,124,63,240,63,255,224,31,255,128,15,254,0,3,240,0,
  26,35,140,28,1,0,0,1,192,0,0,1,192,0,0,3,
  192,0,0,7,192,0,0,7,192,0,0,15,224,0,0,15,
  192,0,0,31,192,0,0,63,192,0,0,127,192,0,0,127,
  192,0,0,255,192,0,1,255,192,0,1,247,192,0,3,231,
  192,0,3,199,192,0,7,135,192,0,7,135,192,0,15,7,
  192,0,14,7,192,0,30,15,192,0,31,15,224,0,63,255,
  255,0,127,255,255,128,127,255,255,128,255,255,254,0,0,31,
  192,0,0,7,192,0,0,7,224,0,0,15,240,0,0,63,
  255,0,1,255,255,192,3,255,255,192,3,255,255,128,0,127,
  254,0,22,34,102,29,3,0,15,255,0,63,255,192,63,255,
  128,63,255,0,63,248,0,15,192,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,0,7,252,0,31,255,128,63,
  31,224,62,7,240,56,3,248,0,3,248,0,1,252,0,1,
  252,0,1,252,0,1,252,0,1,252,124,1,252,124,3,252,
  254,3,248,254,15,248,252,15,240,112,7,240,120,15,224,62,
  31,192,31,255,128,15,254,0,7,252,0,1,224,0,21,35,
  105,23,1,0,0,252,0,0,127,0,0,15,0,0,7,128,
  0,7,128,24,15,192,56,15,192,56,15,192,56,15,192,120,
  7,128,120,0,0,120,0,0,120,0,0,120,0,0,248,252,
  0,255,255,0,255,255,128,255,135,192,254,3,224,252,1,224,
  252,1,240,248,1,240,248,1,240,248,1,240,248,1,248,248,
  1,240,248,1,240,248,1,240,248,3,240,112,3,224,32,3,
  224,0,7,192,0,31,128,1,255,0,31,252,0,18,35,105,
  20,1,0,31,255,0,127,255,192,255,255,192,255,255,192,255,
  255,0,127,252,0,0,0,0,0,0,0,0,0,0,0,0,
  0,0,0,0,0,8,0,0,24,0,0,56,0,0,56,0,
  0,56,0,0,120,0,0,120,0,0,248,0,0,248,0,0,
  248,0,1,248,0,1,248,0,1,248,0,3,248,0,3,248,
  0,3,248,0,3,248,0,3,248,0,3,248,0,3,248,0,
  3,248,0,1,248,0,1,248,0,0,240,0,23,35,105,25,
  1,0,1,254,0,7,255,192,15,255,224,30,1,240,60,0,
  240,56,0,248,112,0,248,112,0,248,240,0,248,248,0,240,
  252,0,240,254,0,240,127,193,224,63,255,224,31,255,224,31,
  255,224,15,255,224,7,255,240,15,255,248,31,127,248,60,7,
  252,124,1,252,120,0,254,248,0,126,248,0,62,248,0,30,
  248,0,30,248,0,28,120,0,60,124,0,120,60,1,240,30,
  7,224,15,255,192,7,255,128,1,252,0,21,36,108,23,1,
  0,3,240,0,15,252,0,15,255,0,31,255,128,63,143,192,
  62,3,224,124,3,224,124,1,240,120,1,240,248,1,240,248,
  1,248,248,1,248,248,1,248,248,3,248,248,3,248,248,3,
  248,252,7,248,124,7,240,126,15,240,62,15,240,28,7,240,
  0,1,240,0,1,224,0,1,224,0,1,224,62,1,192,62,
  0,128,62,0,0,62,0,0,60,14,0,60,63,0,31,255,
  0,31,254,0,15,252,0,15,248,0,7,192,0};
  

const u8g_fntpgm_uint8_t witch38n[1413] U8G_FONT_SECTION("witch38n") = {
  0,85,91,248,239,39,0,0,0,0,48,57,0,40,255,39,
  0,25,40,160,29,2,255,0,16,0,0,1,254,0,0,3,
  255,0,0,7,255,192,0,15,255,224,0,15,135,224,0,31,
  3,240,0,30,1,248,0,62,1,248,0,62,0,252,0,124,
  0,252,0,124,0,254,0,124,0,126,0,124,0,127,0,252,
  0,127,0,252,0,127,0,252,0,127,0,252,0,127,0,252,
  0,127,128,252,0,127,128,252,0,127,128,252,0,127,128,252,
  0,127,128,252,0,127,128,252,0,127,128,124,0,127,128,124,
  0,127,128,124,0,127,0,60,0,127,0,60,0,127,0,62,
  0,254,0,30,0,254,0,14,0,252,0,14,0,248,0,7,
  3,248,0,7,255,240,0,3,255,224,0,1,255,192,0,0,
  255,128,0,0,62,0,0,21,39,117,25,2,255,0,60,0,
  15,252,0,127,252,0,255,252,0,255,252,0,63,252,0,1,
  252,0,1,252,0,0,252,0,0,252,0,0,252,0,0,252,
  0,0,252,0,0,252,0,0,252,0,0,248,0,0,248,0,
  0,248,0,0,248,0,0,248,0,0,248,0,0,248,0,0,
  248,0,0,248,0,0,248,0,0,248,0,0,252,0,0,252,
  0,0,252,0,0,252,0,0,252,0,0,254,0,1,254,0,
  3,255,0,127,255,240,255,255,248,255,255,248,127,255,240,15,
  255,128,24,40,120,28,2,0,0,255,0,3,255,224,7,195,
  248,14,1,252,28,0,254,24,0,126,48,0,63,112,0,63,
  96,0,63,64,0,31,192,0,31,192,0,63,192,0,63,254,
  0,62,255,0,126,127,128,126,63,128,252,15,0,248,0,1,
  240,0,3,240,0,7,192,0,15,128,0,14,0,0,28,0,
  0,56,0,0,96,0,0,192,0,1,128,0,1,128,0,3,
  0,1,7,0,3,14,0,3,15,128,31,31,255,255,31,255,
  255,63,255,255,63,255,255,63,255,255,31,255,255,7,255,254,
  27,39,156,31,2,255,0,254,0,0,7,255,192,0,15,255,
  240,0,31,255,248,0,31,255,252,0,63,192,254,0,63,192,
  126,0,63,224,126,0,63,224,126,0,63,224,124,0,31,192,
  124,0,31,192,252,0,0,1,248,0,0,1,240,0,0,7,
  240,0,0,63,224,0,7,255,192,0,3,255,192,0,0,127,
  224,0,0,3,252,0,0,0,255,0,0,0,127,128,0,0,
  63,128,0,0,63,128,31,0,63,128,127,128,63,192,127,128,
  63,224,255,128,63,224,255,0,127,224,255,0,127,224,254,0,
  255,192,254,0,255,192,124,1,255,128,126,7,255,0,63,255,
  254,0,31,255,252,0,15,255,240,0,7,255,128,0,1,252,
  0,0,29,39,156,32,1,255,0,0,48,0,0,0,112,0,
  0,0,248,0,0,1,248,0,0,1,248,0,0,3,248,0,
  0,3,248,0,0,7,248,0,0,15,248,0,0,15,248,0,
  0,31,248,0,0,63,248,0,0,127,240,0,0,127,240,0,
  0,253,240,0,0,249,240,0,1,241,240,0,3,225,240,0,
  3,225,240,0,7,193,240,0,7,129,240,0,15,131,240,0,
  15,3,240,0,31,135,248,0,31,255,255,192,63,255,255,240,
  63,255,255,240,127,255,255,224,255,255,254,0,0,3,240,0,
  0,1,240,0,0,1,248,0,0,3,252,0,0,7,255,192,
  0,255,255,240,1,255,255,248,1,255,255,248,0,255,255,240,
  0,31,255,128,24,38,114,31,3,0,7,255,192,15,255,240,
  31,255,240,31,255,224,31,255,128,15,252,0,7,224,0,0,
  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  0,7,255,0,31,255,224,31,135,248,31,3,252,30,1,252,
  0,1,254,0,0,254,0,0,255,0,0,255,0,0,255,0,
  0,255,24,0,255,126,0,255,126,1,255,255,1,254,255,7,
  254,255,7,252,120,3,252,124,3,248,62,7,240,63,255,224,
  31,255,192,15,255,0,3,254,0,0,240,0,23,39,117,27,
  2,0,0,126,0,0,63,128,0,15,192,0,3,224,0,3,
  224,8,3,240,28,7,240,28,7,240,60,7,240,60,7,240,
  60,3,192,124,0,0,120,0,0,120,0,0,120,0,0,124,
  126,0,255,255,192,255,255,224,255,195,240,255,129,248,255,0,
  248,254,0,252,252,0,252,252,0,254,252,0,254,252,0,254,
  248,0,254,248,0,254,248,0,254,248,0,254,248,0,252,248,
  0,252,120,1,252,48,1,248,0,3,248,0,7,240,0,31,
  224,1,255,128,31,254,0,21,39,117,25,2,255,31,255,192,
  127,255,240,255,255,248,255,255,248,255,255,240,255,255,224,63,
  254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  0,0,4,0,0,12,0,0,12,0,0,28,0,0,28,0,
  0,60,0,0,60,0,0,124,0,0,124,0,0,252,0,0,
  252,0,0,252,0,1,252,0,1,252,0,1,252,0,1,252,
  0,3,252,0,3,252,0,3,252,0,3,252,0,3,252,0,
  3,252,0,3,252,0,3,252,0,1,252,0,1,248,0,0,
  120,0,25,39,156,29,2,0,0,255,0,0,3,255,224,0,
  15,255,248,0,15,128,252,0,30,0,124,0,60,0,126,0,
  56,0,126,0,120,0,126,0,120,0,126,0,248,0,126,0,
  252,0,124,0,252,0,124,0,255,0,120,0,127,192,248,0,
  127,251,240,0,63,255,240,0,31,255,240,0,15,255,240,0,
  7,255,248,0,7,255,248,0,15,255,252,0,31,255,254,0,
  62,7,254,0,124,1,255,0,124,0,127,0,252,0,63,128,
  248,0,31,128,248,0,15,128,248,0,15,128,248,0,15,128,
  252,0,15,0,124,0,31,0,124,0,30,0,62,0,126,0,
  30,1,252,0,15,7,248,0,7,255,224,0,3,255,192,0,
  0,254,0,0,24,41,123,28,2,255,1,248,0,7,255,0,
  15,255,192,15,255,224,31,255,240,31,193,248,63,128,248,63,
  0,252,126,0,124,126,0,126,124,0,126,252,0,127,252,0,
  127,252,0,127,252,0,127,252,0,255,252,0,255,254,0,255,
  254,1,255,127,1,254,127,3,254,63,3,254,63,3,254,14,
  0,254,0,0,124,0,0,124,0,0,124,0,0,120,14,0,
  120,31,0,112,63,0,0,63,0,0,63,0,0,31,3,128,
  31,15,192,31,63,192,15,255,128,15,255,128,15,255,0,7,
  252,0,3,224,0};
  

const u8g_fntpgm_uint8_t witch42n[1719] U8G_FONT_SECTION("witch42n") = {
  0,93,101,248,237,43,0,0,0,0,48,57,0,44,255,43,
  0,28,43,172,32,2,255,0,126,0,0,1,255,128,0,3,
  255,224,0,7,255,240,0,7,255,248,0,15,193,252,0,31,
  128,254,0,31,0,126,0,63,0,127,0,63,0,63,128,63,
  0,63,128,126,0,63,128,126,0,63,192,126,0,31,192,126,
  0,31,224,254,0,31,224,254,0,31,224,254,0,31,224,254,
  0,31,224,254,0,31,240,254,0,31,240,254,0,31,240,254,
  0,31,240,254,0,31,240,254,0,31,240,254,0,31,240,254,
  0,31,240,126,0,31,240,126,0,31,240,126,0,31,224,62,
  0,31,224,63,0,31,224,31,0,63,192,31,0,63,192,15,
  0,63,128,15,0,127,0,7,128,255,0,3,255,254,0,3,
  255,252,0,1,255,248,0,0,255,240,0,0,127,192,0,0,
  31,128,0,24,43,129,28,2,255,0,30,0,63,255,0,127,
  255,0,255,255,0,255,255,0,127,255,0,63,255,0,1,255,
  0,0,255,0,0,255,0,0,127,0,0,127,0,0,127,0,
  0,126,0,0,126,0,0,126,0,0,126,0,0,126,0,0,
  126,0,0,126,0,0,126,0,0,126,0,0,126,0,0,126,
  0,0,126,0,0,126,0,0,126,0,0,126,0,0,126,0,
  0,126,0,0,126,0,0,127,0,0,127,0,0,127,0,0,
  255,0,0,255,128,0,255,192,15,255,248,127,255,254,255,255,
  255,255,255,255,127,255,254,7,255,224,26,44,176,30,2,0,
  0,127,128,0,1,255,240,0,7,255,252,0,7,129,254,0,
  15,0,127,0,30,0,63,128,28,0,63,128,56,0,31,192,
  112,0,31,192,96,0,15,192,96,0,15,192,192,0,15,192,
  192,0,15,192,192,0,15,192,224,0,31,192,255,0,31,128,
  255,128,31,128,127,128,63,0,63,128,127,0,15,0,126,0,
  0,0,252,0,0,1,248,0,0,1,240,0,0,3,224,0,
  0,7,192,0,0,15,0,0,0,30,0,0,0,60,0,0,
  0,112,0,0,0,96,0,0,0,192,0,0,1,192,0,64,
  3,128,0,192,3,0,0,192,7,0,1,192,15,0,3,192,
  15,128,15,192,31,255,255,192,63,255,255,192,63,255,255,192,
  63,255,255,192,63,255,255,192,31,255,255,128,3,255,254,0,
  29,43,172,33,2,255,0,127,128,0,3,255,240,0,7,255,
  252,0,15,255,255,0,31,255,255,128,63,192,255,128,63,224,
  63,192,63,240,31,192,63,240,31,192,63,240,31,192,63,240,
  31,128,31,224,31,128,31,224,63,0,7,0,127,0,0,0,
  126,0,0,1,254,0,0,3,252,0,3,255,248,0,7,255,
  248,0,1,255,240,0,0,63,252,0,0,1,255,128,0,0,
  127,192,0,0,63,224,0,0,63,224,0,0,31,224,15,0,
  31,224,63,128,31,240,127,192,31,248,127,192,31,248,255,128,
  31,248,255,128,63,248,255,128,63,248,255,0,127,240,254,0,
  127,240,126,0,255,224,126,1,255,192,63,7,255,128,63,255,
  255,0,31,255,254,0,7,255,248,0,3,255,192,0,0,254,
  0,0,32,43,172,36,2,255,0,0,24,0,0,0,60,0,
  0,0,124,0,0,0,124,0,0,0,254,0,0,1,254,0,
  0,1,254,0,0,3,254,0,0,3,254,0,0,7,254,0,
  0,15,254,0,0,31,252,0,0,31,252,0,0,63,252,0,
  0,127,252,0,0,127,252,0,0,254,252,0,0,252,252,0,
  1,248,252,0,3,240,252,0,3,224,252,0,7,224,252,0,
  7,192,252,0,15,128,252,0,15,128,252,0,31,1,252,0,
  31,131,254,0,63,255,255,248,63,255,255,252,127,255,255,254,
  127,255,255,252,255,255,255,248,0,3,254,0,0,0,252,0,
  0,0,252,0,0,0,254,0,0,1,255,128,0,15,255,248,
  0,255,255,254,1,255,255,255,1,255,255,255,0,255,255,254,
  0,15,255,224,27,42,168,36,4,0,3,255,240,0,15,255,
  252,0,31,255,252,0,31,255,248,0,31,255,240,0,31,255,
  192,0,15,254,0,0,7,240,0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  0,0,1,255,128,0,15,255,248,0,31,255,254,0,31,193,
  255,0,31,128,255,128,31,0,127,192,0,0,63,192,0,0,
  63,192,0,0,31,224,0,0,31,224,0,0,31,224,0,0,
  31,224,0,0,31,224,62,0,31,224,127,0,31,224,127,0,
  63,192,255,128,63,192,255,128,255,192,255,129,255,128,124,0,
  255,128,124,0,255,0,62,1,254,0,63,131,252,0,31,255,
  248,0,15,255,240,0,7,255,192,0,1,255,0,0,0,120,
  0,0,25,43,172,29,2,0,0,63,128,0,0,63,192,0,
  0,15,240,0,0,3,240,0,0,1,248,0,0,1,248,0,
  12,1,252,0,30,3,252,0,30,3,252,0,62,3,252,0,
  62,3,252,0,60,3,252,0,60,1,240,0,124,0,0,0,
  124,0,0,0,124,0,0,0,124,0,0,0,124,63,128,0,
  127,255,224,0,255,255,248,0,255,225,252,0,255,192,126,0,
  255,128,126,0,255,0,63,0,254,0,63,0,254,0,63,128,
  254,0,63,128,252,0,63,128,252,0,63,128,252,0,63,128,
  252,0,63,128,252,0,63,128,252,0,63,128,252,0,127,128,
  252,0,127,128,120,0,127,0,120,0,127,0,16,0,254,0,
  0,1,254,0,0,3,252,0,0,31,248,0,0,255,224,0,
  15,255,128,0,23,43,129,27,2,255,15,255,240,127,255,252,
  255,255,254,255,255,254,255,255,252,127,255,240,63,255,128,0,
  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  0,0,1,0,0,3,0,0,7,0,0,7,0,0,15,0,
  0,15,0,0,31,0,0,31,0,0,63,0,0,63,0,0,
  63,0,0,127,0,0,127,0,0,255,0,0,255,0,0,255,
  0,0,255,0,1,255,0,1,255,0,1,255,0,1,255,0,
  1,255,0,1,255,0,1,255,0,1,255,0,1,255,0,0,
  255,0,0,255,0,0,126,0,0,60,0,28,43,172,32,2,
  0,0,127,192,0,1,255,248,0,7,255,254,0,15,192,127,
  0,31,0,63,128,30,0,31,192,60,0,31,192,60,0,31,
  192,120,0,31,192,120,0,31,192,252,0,31,192,252,0,31,
  128,254,0,31,128,255,0,31,0,127,192,63,0,127,248,126,
  0,63,255,254,0,31,255,252,0,15,255,254,0,7,255,254,
  0,7,255,254,0,3,255,255,0,7,255,255,128,15,255,255,
  128,31,3,255,192,62,0,255,192,126,0,63,224,124,0,31,
  224,252,0,7,240,252,0,7,240,252,0,3,240,252,0,3,
  240,252,0,3,240,252,0,3,224,124,0,3,224,126,0,7,
  192,62,0,15,192,62,0,31,128,31,0,127,0,15,131,254,
  0,7,255,248,0,1,255,240,0,0,127,128,0,26,45,180,
  30,2,255,1,252,0,0,3,255,128,0,7,255,224,0,15,
  255,240,0,15,255,248,0,31,225,252,0,63,192,254,0,63,
  128,126,0,63,128,127,0,127,0,63,0,127,0,63,128,127,
  0,63,128,254,0,63,192,254,0,63,192,254,0,63,192,254,
  0,63,192,254,0,127,192,254,0,127,192,254,0,127,192,255,
  0,255,192,255,0,255,192,127,128,255,128,127,129,255,128,63,
  129,255,128,31,129,255,128,15,0,255,128,0,0,63,0,0,
  0,63,0,0,0,63,0,0,0,62,0,0,0,62,0,15,
  128,60,0,31,128,28,0,31,128,0,0,31,128,0,0,31,
  128,0,0,31,128,0,0,31,131,224,0,31,143,224,0,15,
  255,224,0,15,255,192,0,7,255,192,0,7,255,0,0,3,
  254,0,0,1,240,0,0};
  
  






//fonty

#define WIDTH 128

//#define DEBUG

#define INP 9
#define DISPLAY 2

#define LONG_PRESS 1000

char str[10];
uint8_t draw_state = 0;
uint8_t range_selected = 2;

Bounce btn = Bounce();

int btnSt = 0,x;
unsigned long btnTS = 0, selTS=0;

boolean disTS = false;


PROGMEM prog_uint16_t range[8][2] = {{10,50},{50,120},{100,500},{300,800},{700,1200},{900,2000},{1000,5000},{1200,9999}};
U8GLIB_SSD1306_128X64_2X u8g(U8G_I2C_OPT_NONE);	// I2C / TWI 


ISR(WDT_vect) { 
  Sleepy::watchdogEvent(); 
}


void draw(void) {
  switch(draw_state >> 3) {
  case 0:
    u8g.setDefaultBackgroundColor();
    u8g.drawPixel(1, 1);
    u8g.setDefaultForegroundColor();
    break;
  case 1: 
    draw_range_select(false); 
    break;
  case 2:
    draw_random(); 
    break;
  case 3:
    draw_range_select(true);
    break;
  }
}


void draw_range_select(boolean sel){
  int i,j;
  
  u8g.setFont(u8g_font_helvR08);
  u8g.drawStr((WIDTH - u8g.getStrWidth("Zvolte rozsah:"))/2, 22, "Zvolte rozsah:");

  i = pgm_read_word(&(range[draw_state&7][0]));
  j = pgm_read_word(&(range[draw_state&7][1]));
  
  sprintf(str,"%d-%d",i,j);

  if(sel){
    u8g.drawBox(0, 28, 127, 21);
    u8g.setDefaultBackgroundColor();    
  }

  u8g.setFont(u8g_font_fub17n);
  u8g.drawStr((WIDTH - u8g.getStrWidth(str))/2, 46, str); 
  if(sel){
    u8g.setDefaultForegroundColor();
  }
}

void draw_random(){  
int line;
switch(draw_state&7){
  case 0: line = 38; u8g.setFont(witch14n); break;
  case 1: line = 40; u8g.setFont(witch18n); break;
  case 2: line = 42; u8g.setFont(witch22n); break;
  case 3: line = 44; u8g.setFont(witch26n); break;
  case 4: line = 46; u8g.setFont(witch30n); break;
  case 5: line = 48; u8g.setFont(witch34n); break;  
  case 6: line = 50; u8g.setFont(witch38n); break;
  case 7: line = 52; u8g.setFont(witch42n); break;
}
  u8g.drawStr((WIDTH - u8g.getStrWidth(str))/2, line, str);  
}

void setup(void) {
  randomSeed(analogRead(0));
  
  pinMode(INP, INPUT); 
  digitalWrite(INP, HIGH);

  pinMode(DISPLAY,OUTPUT);
  digitalWrite(DISPLAY, HIGH);
  
  btn.attach(INP); 
  btn.interval(5);

  u8g.setRot180();
  
#ifdef DEBUG  
  Serial.begin(115200);
#endif
}


boolean btnChng, btnVal;
int old_draw_state=-1;

void loop(void) {

#ifdef DEBUG  
  Serial.print(draw_state);
  Serial.print(F(" zacinam zobrazovat ... "));
  unsigned long m = millis();
  int ii=0;
#endif

  if(old_draw_state != draw_state){


    u8g.firstPage();  
    do {
      draw();
#ifdef DEBUG  
ii++;
#endif

    } 
    while( u8g.nextPage() );
  old_draw_state = draw_state;
  
  }
  else{
#ifndef DEBUG  
 Sleepy::loseSomeTime(50);
#endif
#ifdef DEBUG  
 delay(50);
#endif      
    
  }
  
#ifdef DEBUG  
  unsigned long n = millis();
  Serial.print(F(" ... zobrazeno. "));
  Serial.print(n-m);
  Serial.print(F("ms. "));
  Serial.print(ii);
  Serial.println(F(" pruchodu."));
#endif
  
  
  if((draw_state >> 3) == 2){
    if((draw_state&7) < 7)
      draw_state++;
  }
  
  btnChng = btn.update();
  if(btnChng){
#ifdef DEBUG  
    Serial.println(F("Stisknute tlacitko"));
#endif
    btnVal = btn.read();
    
    if(btnVal == HIGH){ //tlacitko bylo pusteno
      if(btnSt == 2){ //dlouhy stisk
        if((draw_state >> 3) != 1) //nevybiram
          draw_state = 8 + range_selected;
        else{ //vybral jsem
          range_selected = draw_state&7;
          draw_state = 3*8+range_selected;
          selTS = millis();
          disTS = true;
        }
      }
      if(btnSt == 1){ //kratky stisk
        if(draw_state >> 3 == 1){ //vybiram range
          draw_state++; //posunu range o 1;
          if(draw_state >> 3 == 2) //nepretekl jsem
           draw_state = 8; 
        }
        else //jinak zacnu zobrazovat
        {
          x = pgm_read_word(&(range[range_selected][0])) + random(pgm_read_word(&(range[range_selected][1])) - pgm_read_word(&(range[range_selected][0])));
          sprintf(str, "%d", x);
#ifdef DEBUG  
          Serial.println();Serial.println();
          Serial.print(F("Generuji... "));
          Serial.print(pgm_read_word(&(range[range_selected][0])));
          Serial.print(F("..."));
          Serial.print(pgm_read_word(&(range[range_selected][1])));
          Serial.print(F(" - "));
          Serial.println(str);
          Serial.println();Serial.println();
#endif
       
          draw_state = 16;
        }
        
      }
    }
    else{ //tlacitko je stisknuto
      btnSt = 1; //je stisknuto alespon kratce
      btnTS = millis();
    }
  }
  
  if((btnSt == 1) && (millis() - btnTS >= LONG_PRESS)) //tlacitko je stitknuto dlouze
    btnSt = 2;
    
  if(disTS && ((long) millis() - (long) selTS > LONG_PRESS)){
    disTS = false;
    draw_state = 0;
#ifdef DEBUG  
          Serial.println();Serial.println();
          Serial.println(F("Cistim display "));
          Serial.print(millis());
          Serial.print(F(" "));
          Serial.print(selTS);
          Serial.println();Serial.println();
#endif    
  }
  
  
  if(draw_state == 23 && !disTS){
     disTS = true;
     selTS = millis()+10000L;
     
#ifdef DEBUG  
          Serial.println();Serial.println();
          Serial.print(F("Nastavuji cisteni "));
          Serial.print(millis());
          Serial.print(F(" "));
          Serial.print(selTS);
          Serial.println();Serial.println();
#endif    

  }
}

